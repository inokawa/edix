(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}})();const ye=([e],[t])=>e===t?0:e<t?1:-1,Z=(e,t)=>{const n=ye(e,t);return n===0?e[1]===t[1]?0:e[1]<t[1]?1:-1:n},ve=([e,t])=>Z(e,t)===-1?[t,e]:[e,t],Ee=(e,t)=>e.reduce((n,r,i)=>(i!==0&&(n+=`
`),n+r.reduce((a,d)=>a+(ce(d)?d.text:t?t(d):""),"")),""),Se=e=>e.split(`
`).map(t=>t?[{text:t}]:[]),je=e=>e.t!==3;class re extends Array{static from(t){return new re(...t)}insert(t,n){return this.push({t:2,o:t,i:n}),this}delete(t,n){return this.push({t:1,l:t,u:n}),this}select(t,n){return this.push({t:3,p:t,h:n}),this}rebasePos(t){return this.reduce((n,r)=>je(r)?Oe(n,r):n,t)}}const ce=e=>"text"in e,ze=e=>ce(e)?e.text.length:1,tt=e=>e.reduce((t,n)=>t+ze(n),0),me=(e,t)=>{const n=[...e];if(n.length)for(const r of t){const i=n.length-1,a=n[i];ce(r)&&ce(a)?n[i]={text:a.text+r.text}:n.push(r)}else n.push(...t);return n},de=(e,t)=>{for(let n=0;n<e.length;n++){const r=e[n],i=ze(r);if(i>t){const a=e.slice(0,n),d=e.slice(n+1);if(ce(r)){const b=r.text.slice(0,t),y=r.text.slice(t);b&&a.push({text:b}),y&&d.unshift({text:y})}else d.unshift(r);return[a,d]}t-=i}return[e,[]]},Ue=(e,t,n,r)=>{const[i]=n,[a]=r||n,d=de(e[n[0]],n[1]),b=d[0],y=r?de(e[r[0]],r[1])[1]:d[1],f=[...t];f.length?(f[0]=me(b,f[0]),f[f.length-1]=me(f[f.length-1],y)):f.push(me(b,y)),e.splice(i,a-i+1,...f)},nt=e=>{switch(e.t){case 1:return Z(e.l,e.u)===1;case 2:return!!Ee(e.i)}return!0},rt=(e,t)=>{switch(t.t){case 1:Ue(e,[],t.l,t.u);break;case 2:Ue(e,t.i,t.o)}},Oe=(e,t)=>{switch(t.t){case 1:{const{l:n,u:r}=t;if(Z(e,n)!==1)return Z(r,e)===1?[e[0]+n[0]-r[0],e[1]+(ye(r,e)===0?n[1]-r[1]:0)]:n;break}case 2:{const{o:n,i:r}=t,i=r.length,a=i-1;if(Z(e,n)!==1)return[e[0]+a,e[1]+(ye(e,n)===0?tt(r[i-1])-(a===0?0:n[1]):0)];break}}return e},it=(e,t,n)=>{const r=[...e],i=[...t];try{for(const a of n)nt(a)&&(je(a)?(rt(e,a),t[0]=Oe(t[0],a),t[1]=Oe(t[1],a)):(a.p&&(t[0]=a.p),a.h&&(t[1]=a.h)))}catch(a){console.error("rollback transaction:",a),e.length=0,e.push(...r),t[0]=i[0],t[1]=i[1]}};let Y,S,q,be,$e,we=!1,De=!1;const at=e=>e.nodeType===3,Te=e=>e.nodeType===1,st=e=>e.nodeType===8,ot=new Set(["EMBED","IMG","PICTURE","AUDIO","VIDEO","SVG","CANVAS","MATH","IFRAME","OBJECT"]),qe=e=>e.contentEditable==="false"||ot.has(e.tagName),lt=()=>S,We=()=>q===1?S.data.length:q===2?1:0,dt=e=>{Y.currentNode=Y.currentNode.parentNode.children[e]},Ie=e=>{const t=e.nextSibling;return!!t&&!st(t)},ut=()=>{for(;;){if(q===2){const e=S;for(;(S=Y.nextNode())&&e.contains(S););}else S=Y.nextNode();if(q=null,!S)break;if(be){if(be.contains(S)){if(we=!0,De)break}else if(we)break}if(at(S)){const e=S.data;if(e)return q=e===`
`?Ie(S)?3:6:1}else if(Te(S)){if(S.tagName==="BR")return q=Ie(S)?3:5;if(qe(S))return q=2;if($e(S))return q=4}}},Je=(e,t,{m:n,_:r},i)=>{try{return $e=r,Y=n.createTreeWalker(t,5),i&&(i.k&&(Y.currentNode=i.k,Y.previousNode()),i.D&&(be=i.D),De=i.v||!1),e(ut)}finally{Y=S=q=be=null,we=De=!1}},ft=Math.min,ct=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},vt=new Set(["DIV","H1","H2","H3","H4","H5","H6","P","PRE","LI","DT","DD","TR"]),pt=e=>vt.has(e.tagName),Ye=e=>e.ownerDocument,Ze=e=>Ye(e).getSelection(),ht=(e,t)=>{if(e.rangeCount){const n=e.getRangeAt(0);if(t.contains(n.commonAncestorContainer))return n}},Ve=(e,t,n)=>{const r=Ze(e);r.removeAllRanges(),r.addRange(t),n&&(r.collapseToEnd(),r.extend(t.startContainer,t.startOffset))},Le=(e,t,[n,r],i)=>{const a=Z(n,r),d=a===0,b=a===-1,y=b?r:n,f=b?n:r;if(y[0]===0&&y[1]===0&&d&&!t.hasChildNodes()){const D=e.createRange();return D.setStart(t,0),D.setEnd(t,0),Ve(t,D),!0}const L=Be(t,y,i);if(!L)return!1;const P=d?L:Be(t,f,i);if(!P)return!1;const E=e.createRange(),[B,G]=L,[H,k]=P;return Te(B)?G<1?E.setStartBefore(B):E.setStartAfter(B):E.setStart(B,G),Te(H)?k<1?E.setEndBefore(H):E.setEndAfter(H):E.setEnd(H,k),Ve(t,E,b),!0},Be=(e,[t,n],r)=>Je(i=>{let a,d=!1;for(;a=i();)if(a===4)d||(d=!0,t!==0&&dt(t));else{const b=We();if(n<=b)return[lt(),n];n-=b}},e,r),Ae=(e,t,n,r)=>{let i,a,d=!0;if(e===t&&!t.hasChildNodes())return[0,0];if(Te(t)&&!qe(t)&&t.hasChildNodes()){const y=ft(n,t.childNodes.length-1);t=t.childNodes[y],d=y===n,n=0}const b=((y,f)=>{let L=f;for(;;){const P=L.parentElement;if(P===y)break;L=P}return L})(e,t);return r._(b)?(i=b,a=(y=>{let f=0;for(;y=y.previousElementSibling;)f++;return f})(i)):(i=e,a=0),Je(y=>{let f,L=0;for(;f=y();)f===3?(a++,L=0):L+=We();return[a,L+n]},i,r,{D:t,v:d})},He=(e,t,{startOffset:n,startContainer:r,endOffset:i,endContainer:a})=>{const d=Ae(e,r,n,t);return[d,r===a&&n===i?d:Ae(e,a,i,t)]},gt=e=>re.from(e.map(t=>t.t===2?{...t,i:[t.i.reduce((n,r)=>me(n,r),[])]}:t)),pe=()=>{},mt=({schema:{single:e,js:t,doc:n,copy:r,paste:i},doc:a,isBlock:d=pt,onChange:b,onKeyDown:y})=>{let f=[[0,0],[0,0]],L=!1,P=pe,E=pe;const B=()=>G.get()[0],G=(s=>{let T=0,O=0;const U=Date.now,x=[s],M=()=>x[T];return{get:M,set:X=>{x[T]=X},undo:()=>T>0?(T--,M()):void 0,redo:()=>T<x.length-1?(T++,M()):void 0,push:X=>{const A=U();T!==0&&A-O<500&&T--,O=A,x[++T]=X,x.splice(T+1),T>500&&(T--,x.shift())}}})([n(a),f]),H=[],k=s=>{L||(H.unshift(s),ie(ae))},D=new Set,ie=s=>{D.has(s)||(D.add(s),ct(()=>{D.delete(s),s()}))},ae=()=>{if(H.length){let O,U=[...B()],x=[...f];for(;O=H.pop();)e&&(O=gt(O)),it(U,x,O);const M=B();T=M,(s=U).length===T.length&&s.every((X,A)=>X===T[A])||(G.set([M,f]),G.push([U,x]),b(t(U))),E(x)}var s,T};return{input:s=>{if(!window.InputEvent||typeof InputEvent.prototype.getTargetRanges!="function")return console.error("beforeinput event is not supported."),pe;const{contentEditable:T,role:O,ariaMultiLine:U,ariaReadOnly:x}=s,M=s.style.whiteSpace;s.role="textbox",s.style.whiteSpace="pre-wrap",e||(s.ariaMultiLine="true");let X=!1,A=!1,F=null,Q=null,I=!1,se=!1,W=!1;const l=Ye(s),o={m:l,_:d};P=()=>{s.contentEditable=L?"false":"true",s.ariaReadOnly=L?"true":null},P();const g=((u,p)=>{let h=!1;const m=[],N=$=>{h&&m.push(...$)},C=new MutationObserver($=>{N($),h||p()}),w=()=>{N(C.takeRecords())};return C.observe(u,{characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{M($){!h&&$&&w(),h=$},O:()=>(w(),m.splice(0)),I(){m.splice(0),C.disconnect()}}})(s,()=>{se&&(Le(l,s,f,o),Q!=null&&(clearTimeout(Q),Q=null))});E=u=>{f=u,Q=setTimeout(()=>{Le(l,s,u,o)})};const c=()=>{f=((u,p)=>{const h=Ze(u),m=ht(h,u);if(!m)return[[0,0],[0,0]];const N=He(u,p,m);return(h.anchorNode===h.focusNode?h.anchorOffset>h.focusOffset:2&(C=h.anchorNode,w=h.focusNode,C.compareDocumentPosition(w)))?[N[1],N[0]]:N;var C,w})(s,o)},v=()=>{const u=g.O();if(g.M(!1),u.length){let p;for(;p=u.pop();)if(p.type==="childList"){const{target:h,removedNodes:m,addedNodes:N,nextSibling:C}=p;for(let w=m.length-1;w>=0;w--)h.insertBefore(m[w],C);for(let w=N.length-1;w>=0;w--)h.removeChild(N[w])}else p.target.nodeValue=p.oldValue;g.O()}k(F),I=!1,F=null,A=Le(l,s,f,o)},j=u=>{if(!I){if(y&&y(u))u.preventDefault();else if((u.metaKey||u.ctrlKey)&&!u.altKey&&u.code==="KeyZ"&&(u.preventDefault(),g.M(!1),!L)){const p=u.shiftKey?G.redo():G.undo();p&&(b(t(p[0])),E(p[1]))}}},V=()=>{I||v()},z=u=>{u.preventDefault();const p=u.inputType;if(p.startsWith("format")||p==="historyUndo"||p==="historyRedo")return;I?g.M(!0):c();const h=u.getTargetRanges()[0];if(h){const m=He(s,o,h);let N=p==="insertParagraph"||p==="insertLineBreak"?`
`:u.data;if(N==null){const C=u.dataTransfer;C&&(N=C.getData("text/plain"))}F||(F=new re().select(...f)),Z(...m)!==0&&F.delete(...m),N&&F.insert(m[0],Se(N))}I||v()},ee=()=>{I||c(),I=!0},_=()=>{v()},te=()=>{se=!0,c()},K=()=>{se=!1},oe=()=>{A?A=!1:!se||I||W||c()},le=u=>{c(),Z(...f)!==0&&r(u,((p,h,m)=>ye(h,m)===0?[de(de(p[h[0]],m[1])[0],h[1])[1]]:[de(p[h[0]],h[1])[1],...p.slice(h[0]+1,m[0]),de(p[m[0]],m[1])[0]])(B(),...ve(f)),s)},xe=u=>{u.preventDefault(),le(u.clipboardData)},Ce=u=>{u.preventDefault(),L||(le(u.clipboardData),k(new re().delete(...ve(f))))},Re=u=>{u.preventDefault();const[p,h]=ve(f);k(new re().delete(p,h).insert(p,i(u.clipboardData,o)))},Me=u=>{u.preventDefault();const p=u.dataTransfer,h=((m,N,{clientX:C,clientY:w},$)=>{if(m.caretPositionFromPoint){const ne=m.caretPositionFromPoint(C,w);if(ne)return Ae(N,ne.offsetNode,ne.offset,$)}else if(m.caretRangeFromPoint){const ne=m.caretRangeFromPoint(C,w);if(ne)return Ae(N,ne.startContainer,ne.startOffset,$)}})(l,s,u,o);if(p&&h){const m=new re;W&&m.delete(...ve(f));const N=m.rebasePos(h);m.select(N,N).insert(N,i(p,o)).select(N),k(m),s.focus({preventScroll:!0})}},Pe=u=>{W=!0,le(u.dataTransfer)},ke=()=>{W=!1};return l.addEventListener("selectionchange",oe),s.addEventListener("keydown",j),s.addEventListener("input",V),s.addEventListener("beforeinput",z),s.addEventListener("compositionstart",ee),s.addEventListener("compositionend",_),s.addEventListener("focus",te),s.addEventListener("blur",K),s.addEventListener("copy",xe),s.addEventListener("cut",Ce),s.addEventListener("paste",Re),s.addEventListener("drop",Me),s.addEventListener("dragstart",Pe),s.addEventListener("dragend",ke),()=>{X||(X=!0,P=E=pe,s.contentEditable=T,s.role=O,s.ariaMultiLine=U,s.ariaReadOnly=x,s.style.whiteSpace=M,g.I(),l.removeEventListener("selectionchange",oe),s.removeEventListener("keydown",j),s.removeEventListener("input",V),s.removeEventListener("beforeinput",z),s.removeEventListener("compositionstart",ee),s.removeEventListener("compositionend",_),s.removeEventListener("focus",te),s.removeEventListener("blur",K),s.removeEventListener("copy",xe),s.removeEventListener("cut",Ce),s.removeEventListener("paste",Re),s.removeEventListener("drop",Me),s.removeEventListener("dragstart",Pe),s.removeEventListener("dragend",ke))}},command:(s,...T)=>{const O=s(B(),f,...T);O&&k(O)},readonly:s=>{L=s,P()}}},yt=({multiline:e}={})=>({single:!e,js:Ee,doc:Se,copy:(t,n)=>{t.setData("text/plain",Ee(n))},paste:t=>Se(t.getData("text/plain"))});var Fe=11;function bt(e,t){var n=t.attributes,r,i,a,d,b;if(!(t.nodeType===Fe||e.nodeType===Fe)){for(var y=n.length-1;y>=0;y--)r=n[y],i=r.name,a=r.namespaceURI,d=r.value,a?(i=r.localName||i,b=e.getAttributeNS(a,i),b!==d&&(r.prefix==="xmlns"&&(i=r.name),e.setAttributeNS(a,i,d))):(b=e.getAttribute(i),b!==d&&e.setAttribute(i,d));for(var f=e.attributes,L=f.length-1;L>=0;L--)r=f[L],i=r.name,a=r.namespaceURI,a?(i=r.localName||i,t.hasAttributeNS(a,i)||e.removeAttributeNS(a,i)):t.hasAttribute(i)||e.removeAttribute(i)}}var he,Tt="http://www.w3.org/1999/xhtml",R=typeof document>"u"?void 0:document,At=!!R&&"content"in R.createElement("template"),Lt=!!R&&R.createRange&&"createContextualFragment"in R.createRange();function Nt(e){var t=R.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}function Et(e){he||(he=R.createRange(),he.selectNode(R.body));var t=he.createContextualFragment(e);return t.childNodes[0]}function St(e){var t=R.createElement("body");return t.innerHTML=e,t.childNodes[0]}function Ot(e){return e=e.trim(),At?Nt(e):Lt?Et(e):St(e)}function ge(e,t){var n=e.nodeName,r=t.nodeName,i,a;return n===r?!0:(i=n.charCodeAt(0),a=r.charCodeAt(0),i<=90&&a>=97?n===r.toUpperCase():a<=90&&i>=97?r===n.toUpperCase():!1)}function wt(e,t){return!t||t===Tt?R.createElement(e):R.createElementNS(t,e)}function Dt(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}function Ne(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var _e={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();r==="OPTGROUP"&&(n=n.parentNode,r=n&&n.nodeName.toUpperCase()),r==="SELECT"&&!n.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}Ne(e,t,"selected")},INPUT:function(e,t){Ne(e,t,"checked"),Ne(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var i=r.nodeValue;if(i==n||!n&&i==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n=-1,r=0,i=e.firstChild,a,d;i;)if(d=i.nodeName&&i.nodeName.toUpperCase(),d==="OPTGROUP")a=i,i=a.firstChild;else{if(d==="OPTION"){if(i.hasAttribute("selected")){n=r;break}r++}i=i.nextSibling,!i&&a&&(i=a.nextSibling,a=null)}e.selectedIndex=n}}},fe=1,Ke=11,Ge=3,Xe=8;function J(){}function xt(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function Ct(e){return function(n,r,i){if(i||(i={}),typeof r=="string")if(n.nodeName==="#document"||n.nodeName==="HTML"||n.nodeName==="BODY"){var a=r;r=R.createElement("html"),r.innerHTML=a}else r=Ot(r);else r.nodeType===Ke&&(r=r.firstElementChild);var d=i.getNodeKey||xt,b=i.onBeforeNodeAdded||J,y=i.onNodeAdded||J,f=i.onBeforeElUpdated||J,L=i.onElUpdated||J,P=i.onBeforeNodeDiscarded||J,E=i.onNodeDiscarded||J,B=i.onBeforeElChildrenUpdated||J,G=i.skipFromChildren||J,H=i.addChild||function(l,o){return l.appendChild(o)},k=i.childrenOnly===!0,D=Object.create(null),ie=[];function ae(l){ie.push(l)}function s(l,o){if(l.nodeType===fe)for(var g=l.firstChild;g;){var c=void 0;o&&(c=d(g))?ae(c):(E(g),g.firstChild&&s(g,o)),g=g.nextSibling}}function T(l,o,g){P(l)!==!1&&(o&&o.removeChild(l),E(l),s(l,g))}function O(l){if(l.nodeType===fe||l.nodeType===Ke)for(var o=l.firstChild;o;){var g=d(o);g&&(D[g]=o),O(o),o=o.nextSibling}}O(n);function U(l){y(l);for(var o=l.firstChild;o;){var g=o.nextSibling,c=d(o);if(c){var v=D[c];v&&ge(o,v)?(o.parentNode.replaceChild(v,o),M(v,o)):U(o)}else U(o);o=g}}function x(l,o,g){for(;o;){var c=o.nextSibling;(g=d(o))?ae(g):T(o,l,!0),o=c}}function M(l,o,g){var c=d(o);if(c&&delete D[c],!g){var v=f(l,o);if(v===!1||(v instanceof HTMLElement&&(l=v,O(l)),e(l,o),L(l),B(l,o)===!1))return}l.nodeName!=="TEXTAREA"?X(l,o):_e.TEXTAREA(l,o)}function X(l,o){var g=G(l,o),c=o.firstChild,v=l.firstChild,j,V,z,ee,_;e:for(;c;){for(ee=c.nextSibling,j=d(c);!g&&v;){if(z=v.nextSibling,c.isSameNode&&c.isSameNode(v)){c=ee,v=z;continue e}V=d(v);var te=v.nodeType,K=void 0;if(te===c.nodeType&&(te===fe?(j?j!==V&&((_=D[j])?z===_?K=!1:(l.insertBefore(_,v),V?ae(V):T(v,l,!0),v=_,V=d(v)):K=!1):V&&(K=!1),K=K!==!1&&ge(v,c),K&&M(v,c)):(te===Ge||te==Xe)&&(K=!0,v.nodeValue!==c.nodeValue&&(v.nodeValue=c.nodeValue))),K){c=ee,v=z;continue e}V?ae(V):T(v,l,!0),v=z}if(j&&(_=D[j])&&ge(_,c))g||H(l,_),M(_,c);else{var oe=b(c);oe!==!1&&(oe&&(c=oe),c.actualize&&(c=c.actualize(l.ownerDocument||R)),H(l,c),U(c))}c=ee,v=z}x(l,v,V);var le=_e[l.nodeName];le&&le(l,o)}var A=n,F=A.nodeType,Q=r.nodeType;if(!k){if(F===fe)Q===fe?ge(n,r)||(E(n),A=Dt(n,wt(r.nodeName,r.namespaceURI))):A=r;else if(F===Ge||F===Xe){if(Q===F)return A.nodeValue!==r.nodeValue&&(A.nodeValue=r.nodeValue),A;A=r}}if(A===r)E(n);else{if(r.isSameNode&&r.isSameNode(A))return;if(M(A,r,k),ie)for(var I=0,se=ie.length;I<se;I++){var W=D[ie[I]];W&&T(W,W.parentNode,!1)}}return!k&&A!==n&&n.parentNode&&(A.actualize&&(A=A.actualize(n.ownerDocument||R)),n.parentNode.replaceChild(A,n)),A}}var Rt=Ct(bt);const Mt=document.getElementById("root"),ue=document.createElement("div");ue.style.backgroundColor="white";ue.style.border="solid 1px darkgray";ue.style.padding="8px";Mt.appendChild(ue);const Qe=e=>{let t="";for(const n of e.split(`
`))t+=`<div>${n||"<br />"}</div>`;Rt(ue,`<div>${t}</div>`,{childrenOnly:!0})},et=`Hello world.
こんにちは。
👍❤️🧑‍🧑‍🧒`;Qe(et);mt({doc:et,schema:yt({multiline:!0}),onChange:e=>{Qe(e)}}).input(ue);
