(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();let fe,D,B,me=!1;const We=e=>e.nodeType===3,ue=e=>e.nodeType===1,$e=e=>e.nodeType===8,De=new Set(["DIV","H1","H2","H3","H4","H5","H6","P","PRE","LI","DT","DD","TR"]),je=new Set(["EMBED","IMG","PICTURE","AUDIO","VIDEO","SVG","CANVAS","MATH","IFRAME","OBJECT"]),ye=()=>D,Ie=()=>B===1?D.data.length:B===2?1:0,Ne=e=>!!e.nextSibling,Je=e=>{for(;;){if(B===2){const t=D;for(;(D=fe.nextNode())&&t.contains(D););}else D=fe.nextNode();if(B=null,!D||e&&D===e)break;if(We(D)){if(D.data!==`
`)return B=1;if(Ne(D))return B=3}else if(ue(D)){const t=D.tagName;if(t==="BR"){const n=me;if(me=!0,Ne(D))return B=3;if(!n)return B=5}else{if(D.contentEditable==="false"||je.has(t))return B=2;if(De.has(t)){const n=D.previousElementSibling;if(n&&De.has(n.tagName))return B=4}}}}},be=(e,t,n)=>{try{return fe=t.createTreeWalker(n,5),e(Je)}finally{fe=D=B=null,me=!1}},Fe=([e,t],[n,r])=>e===n?t===r?0:t<r?1:-1:e<n?1:-1,{min:Ce}=Math,Ye=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)},_e=e=>e.ownerDocument,Ae=e=>_e(e).getSelection(),ke=(e,t)=>{if(e.rangeCount){const n=e.getRangeAt(0);if(t.contains(n.commonAncestorContainer))return n}},we=(e,t,n)=>{const r=Ae(e);r.removeAllRanges(),r.addRange(t),n&&(r.collapseToEnd(),r.extend(t.startContainer,t.startOffset))},pe=(e,t,[n,r],a)=>{const i=Fe(n,r),s=i===0,u=i===-1,v=u?r:n,m=u?n:r;if(v[0]===0&&v[1]===0&&s&&!t.hasChildNodes()){const h=e.createRange();return h.setStart(t,0),h.setEnd(t,0),we(t,h),!0}const g=xe(e,t,v,a);if(!g)return!1;const O=s?g:xe(e,t,m,a);if(!O)return!1;const E=e.createRange();{const[h,C]=g;ue(h)?C<1?E.setStartBefore(h):E.setStartAfter(h):E.setStart(h,Ce(C,h.data.length))}{const[h,C]=O;ue(h)?C<1?E.setEndBefore(h):E.setEndAfter(h):E.setEnd(h,Ce(C,h.data.length))}return we(t,E,u),!0},xe=(e,t,[n,r],a)=>be(i=>{for(;i();){const s=Ie();if(r<=s)return[ye(),r];r-=s}},e,a||t.childElementCount===0?t:t.children[n]),he=(e,t,n,r,a)=>{let i,s=n;if(a||t.childElementCount===0)s=t,i=0;else{for(;;){const u=s.parentElement;if(u===t)break;s=u}i=Array.prototype.indexOf.call(t.children,s)}return ue(n)&&(n=n.childNodes[r],r=0),be(u=>{let v,m=0;for(;v=u(n);)v===3?(i++,m=0):m+=Ie();return[i,m+r]},e,s)},Me=(e,t,n)=>{const r=Ae(t),a=ke(r,t);if(!a)return[[0,0],[0,0]];const{startOffset:i,startContainer:s,endOffset:u,endContainer:v}=a,m=s===v?r.anchorOffset>r.focusOffset:!!(2&r.anchorNode.compareDocumentPosition(r.focusNode));let g,O;if(t!==s||n)g=he(e,t,s,i,n),O=r.isCollapsed?g:he(e,t,v,u,n);else{if(!(i===0&&u!==0&&t.children.length<=u))return[[0,0],[0,0]];g=[0,0],O=he(e,t,t.lastElementChild,t.lastElementChild.textContent.length,n)}return[m?O:g,m?g:O]},re=(e,t)=>be(n=>{let r,a=null,i="";const s=[],u=m=>{a||(a=[]),i&&(a.push(i),i=""),m&&a.push(m)},v=()=>{u(),a&&s.push(a),a=null};for(;r=n();)r===1?i+=ye().data:r===2?u(ye()):r!==3&&r!==4||v();return v(),s},e,t),ve=e=>typeof e=="string",Le=e=>ve(e)?e.length:1,Ze=(e,t,n)=>{const r=e[t];ve(n)&&ve(r)?e[t]=r+n:e.splice(t+1,0,n)},ie=(...e)=>{const t=[];for(let n=0;n<e.length;n++){const r=e[n];if(n===0)t.push(...r);else for(const a of r)Ze(t,t.length-1,a)}return t},Te=(e,[t,n])=>{const r=e[t];for(let a=0;a<r.length;a++){const i=r[a],s=Le(i);if(s>n){const u=r.slice(0,a),v=r.slice(a+1);return ve(i)?(u.push(i.slice(0,n)),v.unshift(i.slice(n))):n===0?v.unshift(i):u.push(i),[u,v]}n-=s}return[r,[]]},Ke=(e,t)=>{e[0]=e[1]=t},Ge=(e,t)=>{const[n,r]=t,a=Fe(n,r);if(a!==0){const i=a===-1,s=i?r:n;((u,v,m)=>{const g=v[0],O=m[0];u.splice(g,O-g+1,ie(Te(u,v)[0],Te(u,m)[1]))})(e,s,i?n:r),Ke(t,s)}},Xe=(e,t,n)=>{Ge(e,t);const r=t[0],a=n.length,[i,s]=r,u=n[a-1].reduce((v,m)=>v+Le(m),0);((v,m,g)=>{const[O,E]=Te(v,g),h=m.length,[C]=g;if(h===1)v[C]=ie(O,m[0],E);else{const[I,...P]=m,w=P.pop();v.splice(C,1,ie(O,I),...P,ie(w,E))}})(e,n,r),Ke(t,a===1?[i,s+u]:[i+a-1,u])},Qe=(e,t,n)=>{Xe(e,t,n.split(`
`).map(r=>[r]))},et=(e,{schema:{single:t,data:n,plain:r},onChange:a})=>{const{contentEditable:i,role:s,ariaMultiLine:u,ariaReadOnly:v}=e,m=e.style.whiteSpace;e.role="textbox",e.style.whiteSpace="pre-wrap",t||(e.ariaMultiLine="true");let g=!1,O=!1,E=!1,h=[[0,0],[0,0]],C=null,I=!1,P=!1,w=!1;const W=()=>{e.contentEditable=g?"false":"true",e.ariaReadOnly=g?"true":null};W();const X=[],N=_e(e),F=(l=>{let c=0,A=0;const T=Date.now,b=[l],L=()=>b[c];return{get:L,set:V=>{b[c]=V},undo:()=>c>0?(c--,L()):void 0,redo:()=>c<b.length-1?(c++,L()):void 0,push:V=>{const M=T();A&&M-A<500&&c--,A=M,b[++c]=V,b.splice(c+1),c>500&&(c--,b.shift())}}})([n(re(N,e)),h]),_=((l,c)=>{let A=!1;const T=[],b=M=>{A&&T.push(...M)},L=new MutationObserver(M=>{b(M),A||c()}),V=()=>{b(L.takeRecords())};return L.observe(l,{characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{t(M){!A&&M&&V(),A=M},o:()=>(V(),T.splice(0)),i(){T.splice(0),L.disconnect()}}})(e,()=>{P&&(pe(N,e,h,t),C!=null&&(clearTimeout(C),C=null))}),$=new Set,Q=l=>{$.has(l)||($.add(l),Ye(()=>{$.delete(l),l()}))},j=()=>{const l=h;C=setTimeout(()=>{pe(N,e,l,t)})},se=(l,c,A)=>{if(!g){t&&([l,c]=((b,[[L,V],[M,G]])=>{let Ee=0,Se=0;for(let ne=0;ne<b.length;ne++)for(const qe of b[ne]){const Oe=Le(qe);ne<L&&(Ee+=Oe),ne<M&&(Se+=Oe)}return[[ie(...b)],[[0,Ee+V],[0,Se+G]]]})(l,c));const T=n(l);F.set([F.get()[0],A]),F.push([T,c]),h=c,a(T)}j()},S=()=>{h=Me(N,e,t)},z=()=>{const l=_.o();if(_.t(!1),l.length){const c=Me(N,e,t),A=re(N,e);let T;for(;T=l.pop();)if(T.type==="characterData")T.target.nodeValue=T.oldValue;else if(T.type==="childList"){const{target:b,removedNodes:L,addedNodes:V,nextSibling:M}=T;for(let G=L.length-1;G>=0;G--)b.insertBefore(L[G],M);for(let G=V.length-1;G>=0;G--)b.removeChild(V[G])}_.o(),E=pe(N,e,h,t),se(A,c,h)}},le=()=>{if(X.length){const l=[...h],c=re(N,e);let A;for(;A=X.pop();)A[0](c,l,...A[1]);se(c,l,h)}},J=(l,...c)=>{X.unshift([l,c]),Q(le)},oe=l=>{if(!I&&(l.metaKey||l.ctrlKey)&&!l.altKey&&l.code==="KeyZ"&&(l.preventDefault(),!g)){const c=l.shiftKey?F.redo():F.undo();c&&(_.t(!1),h=c[1],a(c[0]),j())}},ee=()=>{I||w||Q(z)},o=l=>{switch(l.inputType){case"historyUndo":case"historyRedo":return void l.preventDefault();case"insertLineBreak":case"insertParagraph":if(t)return void l.preventDefault()}_.t(!0)},d=()=>{I=!0},y=()=>{I=!1,Q(z)},f=()=>{E?E=!1:!P||I||w||S()},p=l=>{const c=(b=>{const L=ke(Ae(b),b);if(L)return L.cloneContents()})(e);if(!c)return;const A=r(re(N,c)),T=N.createElement("div");T.appendChild(c),l.setData("text/html",T.innerHTML),l.setData("text/plain",A)},k=l=>{l.preventDefault(),p(l.clipboardData)},R=l=>{l.preventDefault(),g||(p(l.clipboardData),J(Ge))},K=l=>{l.preventDefault();const c=l.clipboardData,A=c.getData("text/html");if(A){let T=new DOMParser().parseFromString(A,"text/html").body,b=!1;for(const L of[...T.childNodes])$e(L)?L.data==="StartFragment"?(b=!0,T=new DocumentFragment):L.data==="EndFragment"&&(b=!1):b&&T.appendChild(L);try{return void J(Xe,re(N,T))}catch{}}J(Qe,c.getData("text/plain"))},Y=()=>{P=!0,S()},U=()=>{P=!1},Z=()=>{w=!0},H=()=>{w&&(w=!1,Q(z))};return N.addEventListener("selectionchange",f),e.addEventListener("keydown",oe),e.addEventListener("input",ee),e.addEventListener("beforeinput",o),e.addEventListener("compositionstart",d),e.addEventListener("compositionend",y),e.addEventListener("copy",k),e.addEventListener("cut",R),e.addEventListener("paste",K),e.addEventListener("focus",Y),e.addEventListener("blur",U),e.addEventListener("dragstart",Z),e.addEventListener("dragend",H),{dispose:()=>{O||(O=!0,e.contentEditable=i,e.role=s,e.ariaMultiLine=u,e.ariaReadOnly=v,e.style.whiteSpace=m,_.i(),N.removeEventListener("selectionchange",f),e.removeEventListener("keydown",oe),e.removeEventListener("input",ee),e.removeEventListener("beforeinput",o),e.removeEventListener("compositionstart",d),e.removeEventListener("compositionend",y),e.removeEventListener("copy",k),e.removeEventListener("cut",R),e.removeEventListener("paste",K),e.removeEventListener("focus",Y),e.removeEventListener("blur",U),e.removeEventListener("dragstart",Z),e.removeEventListener("dragend",H))},readonly:l=>{g=l,W()}}},Re=e=>e.reduce((t,n,r)=>(r!==0&&(t+=`
`),t+n.reduce((a,i)=>a+(typeof i=="string"?i:""),"")),""),tt=({multiline:e}={})=>({single:!e,data:Re,plain:Re});var Pe=11;function nt(e,t){var n=t.attributes,r,a,i,s,u;if(!(t.nodeType===Pe||e.nodeType===Pe)){for(var v=n.length-1;v>=0;v--)r=n[v],a=r.name,i=r.namespaceURI,s=r.value,i?(a=r.localName||a,u=e.getAttributeNS(i,a),u!==s&&(r.prefix==="xmlns"&&(a=r.name),e.setAttributeNS(i,a,s))):(u=e.getAttribute(a),u!==s&&e.setAttribute(a,s));for(var m=e.attributes,g=m.length-1;g>=0;g--)r=m[g],a=r.name,i=r.namespaceURI,i?(a=r.localName||a,t.hasAttributeNS(i,a)||e.removeAttributeNS(i,a)):t.hasAttribute(a)||e.removeAttribute(a)}}var de,rt="http://www.w3.org/1999/xhtml",x=typeof document>"u"?void 0:document,at=!!x&&"content"in x.createElement("template"),it=!!x&&x.createRange&&"createContextualFragment"in x.createRange();function st(e){var t=x.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}function lt(e){de||(de=x.createRange(),de.selectNode(x.body));var t=de.createContextualFragment(e);return t.childNodes[0]}function ot(e){var t=x.createElement("body");return t.innerHTML=e,t.childNodes[0]}function dt(e){return e=e.trim(),at?st(e):it?lt(e):ot(e)}function ce(e,t){var n=e.nodeName,r=t.nodeName,a,i;return n===r?!0:(a=n.charCodeAt(0),i=r.charCodeAt(0),a<=90&&i>=97?n===r.toUpperCase():i<=90&&a>=97?r===n.toUpperCase():!1)}function ct(e,t){return!t||t===rt?x.createElement(e):x.createElementNS(t,e)}function ft(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}function ge(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var Ue={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();r==="OPTGROUP"&&(n=n.parentNode,r=n&&n.nodeName.toUpperCase()),r==="SELECT"&&!n.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}ge(e,t,"selected")},INPUT:function(e,t){ge(e,t,"checked"),ge(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var a=r.nodeValue;if(a==n||!n&&a==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n=-1,r=0,a=e.firstChild,i,s;a;)if(s=a.nodeName&&a.nodeName.toUpperCase(),s==="OPTGROUP")i=a,a=i.firstChild;else{if(s==="OPTION"){if(a.hasAttribute("selected")){n=r;break}r++}a=a.nextSibling,!a&&i&&(a=i.nextSibling,i=null)}e.selectedIndex=n}}},ae=1,He=11,Ve=3,Be=8;function q(){}function ut(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function vt(e){return function(n,r,a){if(a||(a={}),typeof r=="string")if(n.nodeName==="#document"||n.nodeName==="HTML"||n.nodeName==="BODY"){var i=r;r=x.createElement("html"),r.innerHTML=i}else r=dt(r);else r.nodeType===He&&(r=r.firstElementChild);var s=a.getNodeKey||ut,u=a.onBeforeNodeAdded||q,v=a.onNodeAdded||q,m=a.onBeforeElUpdated||q,g=a.onElUpdated||q,O=a.onBeforeNodeDiscarded||q,E=a.onNodeDiscarded||q,h=a.onBeforeElChildrenUpdated||q,C=a.skipFromChildren||q,I=a.addChild||function(o,d){return o.appendChild(d)},P=a.childrenOnly===!0,w=Object.create(null),W=[];function X(o){W.push(o)}function N(o,d){if(o.nodeType===ae)for(var y=o.firstChild;y;){var f=void 0;d&&(f=s(y))?X(f):(E(y),y.firstChild&&N(y,d)),y=y.nextSibling}}function F(o,d,y){O(o)!==!1&&(d&&d.removeChild(o),E(o),N(o,y))}function _(o){if(o.nodeType===ae||o.nodeType===He)for(var d=o.firstChild;d;){var y=s(d);y&&(w[y]=d),_(d),d=d.nextSibling}}_(n);function $(o){v(o);for(var d=o.firstChild;d;){var y=d.nextSibling,f=s(d);if(f){var p=w[f];p&&ce(d,p)?(d.parentNode.replaceChild(p,d),j(p,d)):$(d)}else $(d);d=y}}function Q(o,d,y){for(;d;){var f=d.nextSibling;(y=s(d))?X(y):F(d,o,!0),d=f}}function j(o,d,y){var f=s(d);if(f&&delete w[f],!y){var p=m(o,d);if(p===!1||(p instanceof HTMLElement&&(o=p,_(o)),e(o,d),g(o),h(o,d)===!1))return}o.nodeName!=="TEXTAREA"?se(o,d):Ue.TEXTAREA(o,d)}function se(o,d){var y=C(o,d),f=d.firstChild,p=o.firstChild,k,R,K,Y,U;e:for(;f;){for(Y=f.nextSibling,k=s(f);!y&&p;){if(K=p.nextSibling,f.isSameNode&&f.isSameNode(p)){f=Y,p=K;continue e}R=s(p);var Z=p.nodeType,H=void 0;if(Z===f.nodeType&&(Z===ae?(k?k!==R&&((U=w[k])?K===U?H=!1:(o.insertBefore(U,p),R?X(R):F(p,o,!0),p=U,R=s(p)):H=!1):R&&(H=!1),H=H!==!1&&ce(p,f),H&&j(p,f)):(Z===Ve||Z==Be)&&(H=!0,p.nodeValue!==f.nodeValue&&(p.nodeValue=f.nodeValue))),H){f=Y,p=K;continue e}R?X(R):F(p,o,!0),p=K}if(k&&(U=w[k])&&ce(U,f))y||I(o,U),j(U,f);else{var l=u(f);l!==!1&&(l&&(f=l),f.actualize&&(f=f.actualize(o.ownerDocument||x)),I(o,f),$(f))}f=Y,p=K}Q(o,p,R);var c=Ue[o.nodeName];c&&c(o,d)}var S=n,z=S.nodeType,le=r.nodeType;if(!P){if(z===ae)le===ae?ce(n,r)||(E(n),S=ft(n,ct(r.nodeName,r.namespaceURI))):S=r;else if(z===Ve||z===Be){if(le===z)return S.nodeValue!==r.nodeValue&&(S.nodeValue=r.nodeValue),S;S=r}}if(S===r)E(n);else{if(r.isSameNode&&r.isSameNode(S))return;if(j(S,r,P),W)for(var J=0,oe=W.length;J<oe;J++){var ee=w[W[J]];ee&&F(ee,ee.parentNode,!1)}}return!P&&S!==n&&n.parentNode&&(S.actualize&&(S=S.actualize(n.ownerDocument||x)),n.parentNode.replaceChild(S,n)),S}}var pt=vt(nt);const ht=document.getElementById("root"),te=document.createElement("div");te.style.backgroundColor="white";te.style.border="solid 1px darkgray";te.style.padding="8px";ht.appendChild(te);const ze=e=>{let t="";for(const n of e.split(`
`))t+=`<div>${n||"<br />"}</div>`;pt(te,`<div>${t}</div>`,{childrenOnly:!0})};ze(`Hello World.
こんにちは。
👍❤️🧑‍🧑‍🧒`);et(te,{schema:tt({multiline:!0}),onChange:e=>{ze(e)}});
