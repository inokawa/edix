(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))r(_);new MutationObserver(_=>{for(const o of _)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(_){const o={};return _.integrity&&(o.integrity=_.integrity),_.referrerPolicy&&(o.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?o.credentials="include":_.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(_){if(_.ep)return;_.ep=!0;const o=n(_);fetch(_.href,o)}})();var Ee,k,yt,J,nt,bt,Ne,$t,Oe,De,Pe,te={},Et=[],It=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Re=Array.isArray;function V(t,e){for(var n in e)t[n]=e[n];return t}function Fe(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ut(t,e,n){var r,_,o,l={};for(o in e)o=="key"?r=e[o]:o=="ref"?_=e[o]:l[o]=e[o];if(arguments.length>2&&(l.children=arguments.length>3?Ee.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)l[o]===void 0&&(l[o]=t.defaultProps[o]);return ce(t,l,r,_,null)}function ce(t,e,n,r,_){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:_??++yt,__i:-1,__u:0};return _==null&&k.vnode!=null&&k.vnode(o),o}function oe(t){return t.children}function fe(t,e){this.props=t,this.context=e}function Y(t,e){if(e==null)return t.__?Y(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?Y(t):null}function kt(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return kt(t)}}function rt(t){(!t.__d&&(t.__d=!0)&&J.push(t)&&!ve.__r++||nt!==k.debounceRendering)&&((nt=k.debounceRendering)||bt)(ve)}function ve(){var t,e,n,r,_,o,l,u;for(J.sort(Ne);t=J.shift();)t.__d&&(e=J.length,r=void 0,o=(_=(n=t).__v).__e,l=[],u=[],n.__P&&((r=V({},_)).__v=_.__v+1,k.vnode&&k.vnode(r),Ie(n.__P,r,_,n.__n,n.__P.namespaceURI,32&_.__u?[o]:null,l,o??Y(_),!!(32&_.__u),u),r.__v=_.__v,r.__.__k[r.__i]=r,xt(l,r,u),r.__e!=o&&kt(r)),J.length>e&&J.sort(Ne));ve.__r=0}function wt(t,e,n,r,_,o,l,u,a,s,d){var i,p,f,b,N,$,v=r&&r.__k||Et,E=e.length;for(a=Bt(n,e,v,a),i=0;i<E;i++)(f=n.__k[i])!=null&&(p=f.__i===-1?te:v[f.__i]||te,f.__i=i,$=Ie(t,f,p,_,o,l,u,a,s,d),b=f.__e,f.ref&&p.ref!=f.ref&&(p.ref&&Ue(p.ref,null,f),d.push(f.ref,f.__c||b,f)),N==null&&b!=null&&(N=b),4&f.__u||p.__k===f.__k?a=Lt(f,a,t):typeof f.type=="function"&&$!==void 0?a=$:b&&(a=b.nextSibling),f.__u&=-7);return n.__e=N,a}function Bt(t,e,n,r){var _,o,l,u,a,s=e.length,d=n.length,i=d,p=0;for(t.__k=[],_=0;_<s;_++)(o=e[_])!=null&&typeof o!="boolean"&&typeof o!="function"?(u=_+p,(o=t.__k[_]=typeof o=="string"||typeof o=="number"||typeof o=="bigint"||o.constructor==String?ce(null,o,null,null,null):Re(o)?ce(oe,{children:o},null,null,null):o.constructor===void 0&&o.__b>0?ce(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=t,o.__b=t.__b+1,l=null,(a=o.__i=Wt(o,n,u,i))!==-1&&(i--,(l=n[a])&&(l.__u|=2)),l==null||l.__v===null?(a==-1&&p--,typeof o.type!="function"&&(o.__u|=4)):a!==u&&(a==u-1?p--:a==u+1?p++:(a>u?p--:p++,o.__u|=4))):o=t.__k[_]=null;if(i)for(_=0;_<d;_++)(l=n[_])!=null&&!(2&l.__u)&&(l.__e==r&&(r=Y(l)),Nt(l,l));return r}function Lt(t,e,n){var r,_;if(typeof t.type=="function"){for(r=t.__k,_=0;r&&_<r.length;_++)r[_]&&(r[_].__=t,e=Lt(r[_],e,n));return e}t.__e!=e&&(e&&t.type&&!n.contains(e)&&(e=Y(t)),n.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function Wt(t,e,n,r){var _=t.key,o=t.type,l=n-1,u=n+1,a=e[n];if(a===null||a&&_==a.key&&o===a.type&&!(2&a.__u))return n;if((typeof o!="function"||o===oe||_)&&r>(a!=null&&!(2&a.__u)?1:0))for(;l>=0||u<e.length;){if(l>=0){if((a=e[l])&&!(2&a.__u)&&_==a.key&&o===a.type)return l;l--}if(u<e.length){if((a=e[u])&&!(2&a.__u)&&_==a.key&&o===a.type)return u;u++}}return-1}function ot(t,e,n){e[0]==="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||It.test(e)?n:n+"px"}function le(t,e,n,r,_){var o;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||ot(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||ot(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace($t,"$1")),e=e.toLowerCase()in t||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r?n.u=r.u:(n.u=Oe,t.addEventListener(e,o?Pe:De,o)):t.removeEventListener(e,o?Pe:De,o);else{if(_=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!=="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function _t(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Oe++;else if(e.t<n.u)return;return n(k.event?k.event(e):e)}}}function Ie(t,e,n,r,_,o,l,u,a,s){var d,i,p,f,b,N,$,v,E,j,c,w,S,F,C,A,O,P=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(a=!!(32&n.__u),o=[u=e.__e=n.__e]),(d=k.__b)&&d(e);e:if(typeof P=="function")try{if(v=e.props,E="prototype"in P&&P.prototype.render,j=(d=P.contextType)&&r[d.__c],c=d?j?j.props.value:d.__:r,n.__c?$=(i=e.__c=n.__c).__=i.__E:(E?e.__c=i=new P(v,c):(e.__c=i=new fe(v,c),i.constructor=P,i.render=qt),j&&j.sub(i),i.props=v,i.state||(i.state={}),i.context=c,i.__n=r,p=i.__d=!0,i.__h=[],i._sb=[]),E&&i.__s==null&&(i.__s=i.state),E&&P.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=V({},i.__s)),V(i.__s,P.getDerivedStateFromProps(v,i.__s))),f=i.props,b=i.state,i.__v=e,p)E&&P.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),E&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(E&&P.getDerivedStateFromProps==null&&v!==f&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(v,c),!i.__e&&(i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(v,i.__s,c)===!1||e.__v===n.__v)){for(e.__v!==n.__v&&(i.props=v,i.state=i.__s,i.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(R){R&&(R.__=e)}),w=0;w<i._sb.length;w++)i.__h.push(i._sb[w]);i._sb=[],i.__h.length&&l.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(v,i.__s,c),E&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(f,b,N)})}if(i.context=c,i.props=v,i.__P=t,i.__e=!1,S=k.__r,F=0,E){for(i.state=i.__s,i.__d=!1,S&&S(e),d=i.render(i.props,i.state,i.context),C=0;C<i._sb.length;C++)i.__h.push(i._sb[C]);i._sb=[]}else do i.__d=!1,S&&S(e),d=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++F<25);i.state=i.__s,i.getChildContext!=null&&(r=V(V({},r),i.getChildContext())),E&&!p&&i.getSnapshotBeforeUpdate!=null&&(N=i.getSnapshotBeforeUpdate(f,b)),u=wt(t,Re(A=d!=null&&d.type===oe&&d.key==null?d.props.children:d)?A:[A],e,n,r,_,o,l,u,a,s),i.base=e.__e,e.__u&=-161,i.__h.length&&l.push(i),$&&(i.__E=i.__=null)}catch(R){if(e.__v=null,a||o!=null)if(R.then){for(e.__u|=a?160:128;u&&u.nodeType===8&&u.nextSibling;)u=u.nextSibling;o[o.indexOf(u)]=null,e.__e=u}else for(O=o.length;O--;)Fe(o[O]);else e.__e=n.__e,e.__k=n.__k;k.__e(R,e,n)}else o==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):u=e.__e=Vt(n.__e,e,n,r,_,o,l,a,s);return(d=k.diffed)&&d(e),128&e.__u?void 0:u}function xt(t,e,n){for(var r=0;r<n.length;r++)Ue(n[r],n[++r],n[++r]);k.__c&&k.__c(e,t),t.some(function(_){try{t=_.__h,_.__h=[],t.some(function(o){o.call(_)})}catch(o){k.__e(o,_.__v)}})}function Vt(t,e,n,r,_,o,l,u,a){var s,d,i,p,f,b,N,$=n.props,v=e.props,E=e.type;if(E==="svg"?_="http://www.w3.org/2000/svg":E==="math"?_="http://www.w3.org/1998/Math/MathML":_||(_="http://www.w3.org/1999/xhtml"),o!=null){for(s=0;s<o.length;s++)if((f=o[s])&&"setAttribute"in f==!!E&&(E?f.localName===E:f.nodeType===3)){t=f,o[s]=null;break}}if(t==null){if(E===null)return document.createTextNode(v);t=document.createElementNS(_,E,v.is&&v),u&&(k.__m&&k.__m(e,o),u=!1),o=null}if(E===null)$===v||u&&t.data===v||(t.data=v);else{if(o=o&&Ee.call(t.childNodes),$=n.props||te,!u&&o!=null)for($={},s=0;s<t.attributes.length;s++)$[(f=t.attributes[s]).name]=f.value;for(s in $)if(f=$[s],s!="children"){if(s=="dangerouslySetInnerHTML")i=f;else if(!(s in v)){if(s=="value"&&"defaultValue"in v||s=="checked"&&"defaultChecked"in v)continue;le(t,s,null,f,_)}}for(s in v)f=v[s],s=="children"?p=f:s=="dangerouslySetInnerHTML"?d=f:s=="value"?b=f:s=="checked"?N=f:u&&typeof f!="function"||$[s]===f||le(t,s,f,$[s],_);if(d)u||i&&(d.__html===i.__html||d.__html===t.innerHTML)||(t.innerHTML=d.__html),e.__k=[];else if(i&&(t.innerHTML=""),wt(t,Re(p)?p:[p],e,n,r,E==="foreignObject"?"http://www.w3.org/1999/xhtml":_,o,l,o?o[0]:n.__k&&Y(n,0),u,a),o!=null)for(s=o.length;s--;)Fe(o[s]);u||(s="value",E==="progress"&&b==null?t.removeAttribute("value"):b!==void 0&&(b!==t[s]||E==="progress"&&!b||E==="option"&&b!==$[s])&&le(t,s,b,$[s],_),s="checked",N!==void 0&&N!==t[s]&&le(t,s,N,$[s],_))}return t}function Ue(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(_){k.__e(_,n)}}function Nt(t,e,n){var r,_;if(k.unmount&&k.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||Ue(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){k.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(_=0;_<r.length;_++)r[_]&&Nt(r[_],e,n||typeof t.type!="function");n||Fe(t.__e),t.__c=t.__=t.__e=void 0}function qt(t,e,n){return this.constructor(t,n)}function Kt(t,e,n){var r,_,o,l;e===document&&(e=document.documentElement),k.__&&k.__(t,e),_=(r=typeof n=="function")?null:e.__k,o=[],l=[],Ie(e,t=(!r&&n||e).__k=Ut(oe,null,[t]),_||te,te,e.namespaceURI,!r&&n?[n]:_?null:e.firstChild?Ee.call(e.childNodes):null,o,!r&&n?n:_?_.__e:e.firstChild,r,l),xt(o,t,l)}Ee=Et.slice,k={__e:function(t,e,n,r){for(var _,o,l;e=e.__;)if((_=e.__c)&&!_.__)try{if((o=_.constructor)&&o.getDerivedStateFromError!=null&&(_.setState(o.getDerivedStateFromError(t)),l=_.__d),_.componentDidCatch!=null&&(_.componentDidCatch(t,r||{}),l=_.__d),l)return _.__E=_}catch(u){t=u}throw t}},yt=0,fe.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=V({},this.state),typeof t=="function"&&(t=t(V({},n),this.props)),t&&V(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),rt(this))},fe.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),rt(this))},fe.prototype.render=oe,J=[],bt=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ne=function(t,e){return t.__v.__b-e.__v.__b},ve.__r=0,$t=/(PointerCapture)$|Capture$/i,Oe=0,De=_t(!1),Pe=_t(!0);var jt=0;function de(t,e,n,r,_,o){e||(e={});var l,u,a=e;"ref"in e&&(l=e.ref,delete e.ref);var s={type:t,props:a,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--jt,__i:-1,__u:0,__source:_,__self:o};if(typeof t=="function"&&(l=t.defaultProps))for(u in l)a[u]===void 0&&(a[u]=l[u]);return k.vnode&&k.vnode(s),s}var ne,x,Le,it,me=0,Dt=[],D=k,st=D.__b,lt=D.__r,at=D.diffed,ut=D.__c,ct=D.unmount,ft=D.__;function Be(t,e){D.__h&&D.__h(x,t,me||e),me=0;var n=x.__H||(x.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function zt(t){return me=1,Gt(St,t)}function Gt(t,e,n){var r=Be(ne++,2);if(r.t=t,!r.__c&&(r.__=[St(void 0,e),function(u){var a=r.__N?r.__N[0]:r.__[0],s=r.t(a,u);a!==s&&(r.__N=[s,r.__[1]],r.__c.setState({}))}],r.__c=x,!x.u)){var _=function(u,a,s){if(!r.__c.__H)return!0;var d=r.__c.__H.__.filter(function(p){return!!p.__c});if(d.every(function(p){return!p.__N}))return!o||o.call(this,u,a,s);var i=r.__c.props!==u;return d.forEach(function(p){if(p.__N){var f=p.__[0];p.__=p.__N,p.__N=void 0,f!==p.__[0]&&(i=!0)}}),o&&o.call(this,u,a,s)||i};x.u=!0;var o=x.shouldComponentUpdate,l=x.componentWillUpdate;x.componentWillUpdate=function(u,a,s){if(this.__e){var d=o;o=void 0,_(u,a,s),o=d}l&&l.call(this,u,a,s)},x.shouldComponentUpdate=_}return r.__N||r.__}function Jt(t,e){var n=Be(ne++,3);!D.__s&&Pt(n.__H,e)&&(n.__=t,n.i=e,x.__H.__h.push(n))}function Zt(t){return me=5,Qt(function(){return{current:t}},[])}function Qt(t,e){var n=Be(ne++,7);return Pt(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Xt(){for(var t;t=Dt.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(pe),t.__H.__h.forEach(Se),t.__H.__h=[]}catch(e){t.__H.__h=[],D.__e(e,t.__v)}}D.__b=function(t){x=null,st&&st(t)},D.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),ft&&ft(t,e)},D.__r=function(t){lt&&lt(t),ne=0;var e=(x=t.__c).__H;e&&(Le===x?(e.__h=[],x.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.i=n.__N=void 0})):(e.__h.forEach(pe),e.__h.forEach(Se),e.__h=[],ne=0)),Le=x},D.diffed=function(t){at&&at(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Dt.push(e)!==1&&it===D.requestAnimationFrame||((it=D.requestAnimationFrame)||Yt)(Xt)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.i=void 0})),Le=x=null},D.__c=function(t,e){e.some(function(n){try{n.__h.forEach(pe),n.__h=n.__h.filter(function(r){return!r.__||Se(r)})}catch(r){e.some(function(_){_.__h&&(_.__h=[])}),e=[],D.__e(r,n.__v)}}),ut&&ut(t,e)},D.unmount=function(t){ct&&ct(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{pe(r)}catch(_){e=_}}),n.__H=void 0,e&&D.__e(e,n.__v))};var dt=typeof requestAnimationFrame=="function";function Yt(t){var e,n=function(){clearTimeout(r),dt&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,100);dt&&(e=requestAnimationFrame(n))}function pe(t){var e=x,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),x=e}function Se(t){var e=x;t.__c=t.__(),x=e}function Pt(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function St(t,e){return typeof e=="function"?e(t):e}const ge=([t],[e])=>t===e?0:t<e?1:-1,K=(t,e)=>{const n=ge(t,e);return n===0?t[1]===e[1]?0:t[1]<e[1]?1:-1:n},ae=([t,e])=>K(t,e)===-1?[e,t]:[t,e],Ce=(t,e)=>t.reduce((n,r,_)=>(_!==0&&(n+=`
`),n+r.reduce((o,l)=>o+(re(l)?l.text:e?e(l):""),"")),""),He=t=>t.split(`
`).map(e=>e?[{text:e}]:[]),Ct=t=>t.t!==3;class Z extends Array{static from(e){return new Z(...e)}insert(e,n){return this.push({t:2,o:e,i:n}),this}delete(e,n){return this.push({t:1,l:e,u:n}),this}select(e,n){return this.push({t:3,p:e,h:n}),this}rebasePos(e){return this.reduce((n,r)=>Ct(r)?Te(n,r):n,e)}}const re=t=>"text"in t,Ht=t=>re(t)?t.text.length:1,en=t=>t.reduce((e,n)=>e+Ht(n),0),he=(t,e)=>{const n=[...t];if(n.length)for(const r of e){const _=n.length-1,o=n[_];re(r)&&re(o)?n[_]={text:o.text+r.text}:n.push(r)}else n.push(...e);return n},X=(t,e)=>{for(let n=0;n<t.length;n++){const r=t[n],_=Ht(r);if(_>e){const o=t.slice(0,n),l=t.slice(n+1);if(re(r)){const u=r.text.slice(0,e),a=r.text.slice(e);u&&o.push({text:u}),a&&l.unshift({text:a})}else l.unshift(r);return[o,l]}e-=_}return[t,[]]},pt=(t,e,n,r)=>{const[_]=n,[o]=r||n,l=X(t[n[0]],n[1]),u=l[0],a=r?X(t[r[0]],r[1])[1]:l[1],s=[...e];s.length?(s[0]=he(u,s[0]),s[s.length-1]=he(s[s.length-1],a)):s.push(he(u,a)),t.splice(_,o-_+1,...s)},tn=t=>{switch(t.t){case 1:return K(t.l,t.u)===1;case 2:return!!Ce(t.i)}return!0},nn=(t,e)=>{switch(e.t){case 1:pt(t,[],e.l,e.u);break;case 2:pt(t,e.i,e.o)}},Te=(t,e)=>{switch(e.t){case 1:{const{l:n,u:r}=e;if(K(t,n)!==1)return K(r,t)===1?[t[0]+n[0]-r[0],t[1]+(ge(r,t)===0?n[1]-r[1]:0)]:n;break}case 2:{const{o:n,i:r}=e,_=r.length,o=_-1;if(K(t,n)!==1)return[t[0]+o,t[1]+(ge(t,n)===0?en(r[_-1])-(o===0?0:n[1]):0)];break}}return t},rn=(t,e,n)=>{const r=[...t],_=[...e];try{for(const o of n)tn(o)&&(Ct(o)?(nn(t,o),e[0]=Te(e[0],o),e[1]=Te(e[1],o)):(o.p&&(e[0]=o.p),o.h&&(e[1]=o.h)))}catch(o){console.error("rollback transaction:",o),t.length=0,t.push(...r),e[0]=_[0],e[1]=_[1]}};let q,H,U,ye,Tt,Me=!1,Ae=!1;const on=t=>t.nodeType===3,be=t=>t.nodeType===1,_n=t=>t.nodeType===8,sn=new Set(["EMBED","IMG","PICTURE","AUDIO","VIDEO","SVG","CANVAS","MATH","IFRAME","OBJECT"]),Mt=t=>t.contentEditable==="false"||sn.has(t.tagName),ln=()=>H,At=()=>U===1?H.data.length:U===2?1:0,an=t=>{q.currentNode=q.currentNode.parentNode.children[t]},ht=t=>{const e=t.nextSibling;return!!e&&!_n(e)},un=()=>{for(;;){if(U===2){const t=H;for(;(H=q.nextNode())&&t.contains(H););}else H=q.nextNode();if(U=null,!H)break;if(ye){if(ye.contains(H)){if(Me=!0,Ae)break}else if(Me)break}if(on(H)){const t=H.data;if(t)return U=t===`
`?ht(H)?3:6:1}else if(be(H)){if(H.tagName==="BR")return U=ht(H)?3:5;if(Mt(H))return U=2;if(Tt(H))return U=4}}},Ot=(t,e,{m:n,_:r},_)=>{try{return Tt=r,q=n.createTreeWalker(e,5),_&&(_.k&&(q.currentNode=_.k,q.previousNode()),_.D&&(ye=_.D),Ae=_.v||!1),t(un)}finally{q=H=U=ye=null,Me=Ae=!1}},cn=Math.min,fn=typeof queueMicrotask=="function"?queueMicrotask:t=>{Promise.resolve().then(t)},dn=new Set(["DIV","H1","H2","H3","H4","H5","H6","P","PRE","LI","DT","DD","TR"]),pn=t=>dn.has(t.tagName),Rt=t=>t.ownerDocument,Ft=t=>Rt(t).getSelection(),hn=(t,e)=>{if(t.rangeCount){const n=t.getRangeAt(0);if(e.contains(n.commonAncestorContainer))return n}},vt=(t,e,n)=>{const r=Ft(t);r.removeAllRanges(),r.addRange(e),n&&(r.collapseToEnd(),r.extend(e.startContainer,e.startOffset))},xe=(t,e,[n,r],_)=>{const o=K(n,r),l=o===0,u=o===-1,a=u?r:n,s=u?n:r;if(a[0]===0&&a[1]===0&&l&&!e.hasChildNodes()){const v=t.createRange();return v.setStart(e,0),v.setEnd(e,0),vt(e,v),!0}const d=mt(e,a,_);if(!d)return!1;const i=l?d:mt(e,s,_);if(!i)return!1;const p=t.createRange(),[f,b]=d,[N,$]=i;return be(f)?b<1?p.setStartBefore(f):p.setStartAfter(f):p.setStart(f,b),be(N)?$<1?p.setEndBefore(N):p.setEndAfter(N):p.setEnd(N,$),vt(e,p,u),!0},mt=(t,[e,n],r)=>Ot(_=>{let o,l=!1;for(;o=_();)if(o===4)l||(l=!0,e!==0&&an(e));else{const u=At();if(n<=u)return[ln(),n];n-=u}},t,r),$e=(t,e,n,r)=>{let _,o,l=!0;if(t===e&&!e.hasChildNodes())return[0,0];if(be(e)&&!Mt(e)&&e.hasChildNodes()){const a=cn(n,e.childNodes.length-1);e=e.childNodes[a],l=a===n,n=0}const u=((a,s)=>{let d=s;for(;;){const i=d.parentElement;if(i===a)break;d=i}return d})(t,e);return r._(u)?(_=u,o=(a=>{let s=0;for(;a=a.previousElementSibling;)s++;return s})(_)):(_=t,o=0),Ot(a=>{let s,d=0;for(;s=a();)s===3?(o++,d=0):d+=At();return[o,d+n]},_,r,{D:e,v:l})},gt=(t,e,{startOffset:n,startContainer:r,endOffset:_,endContainer:o})=>{const l=$e(t,r,n,e);return[l,r===o&&n===_?l:$e(t,o,_,e)]},vn=t=>Z.from(t.map(e=>e.t===2?{...e,i:[e.i.reduce((n,r)=>he(n,r),[])]}:e)),ue=()=>{},mn=({schema:{single:t,js:e,doc:n,copy:r,paste:_},doc:o,isBlock:l=pn,onChange:u,onKeyDown:a})=>{let s=[[0,0],[0,0]],d=!1,i=ue,p=ue;const f=()=>b.get()[0],b=(c=>{let w=0,S=0;const F=Date.now,C=[c],A=()=>C[w];return{get:A,set:O=>{C[w]=O},undo:()=>w>0?(w--,A()):void 0,redo:()=>w<C.length-1?(w++,A()):void 0,push:O=>{const P=F();w!==0&&P-S<500&&w--,S=P,C[++w]=O,C.splice(w+1),w>500&&(w--,C.shift())}}})([n(o),s]),N=[],$=c=>{d||(N.unshift(c),E(j))},v=new Set,E=c=>{v.has(c)||(v.add(c),fn(()=>{v.delete(c),c()}))},j=()=>{if(N.length){let S,F=[...f()],C=[...s];for(;S=N.pop();)t&&(S=vn(S)),rn(F,C,S);const A=f();w=A,(c=F).length===w.length&&c.every((O,P)=>O===w[P])||(b.set([A,s]),b.push([F,C]),u(e(F))),p(C)}var c,w};return{input:c=>{if(!window.InputEvent||typeof InputEvent.prototype.getTargetRanges!="function")return console.error("beforeinput event is not supported."),ue;const{contentEditable:w,role:S,ariaMultiLine:F,ariaReadOnly:C}=c,A=c.style.whiteSpace;c.role="textbox",c.style.whiteSpace="pre-wrap",t||(c.ariaMultiLine="true");let O=!1,P=!1,R=null,_e=null,B=!1,ie=!1,se=!1;const z=Rt(c),W={m:z,_:l};i=()=>{c.contentEditable=d?"false":"true",c.ariaReadOnly=d?"true":null},i();const Q=((h,m)=>{let g=!1;const y=[],L=I=>{g&&y.push(...I)},M=new MutationObserver(I=>{L(I),g||m()}),T=()=>{L(M.takeRecords())};return M.observe(h,{characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),{M(I){!g&&I&&T(),g=I},O:()=>(T(),y.splice(0)),I(){y.splice(0),M.disconnect()}}})(c,()=>{ie&&(xe(z,c,s,W),_e!=null&&(clearTimeout(_e),_e=null))});p=h=>{s=h,_e=setTimeout(()=>{xe(z,c,h,W)})};const ee=()=>{s=((h,m)=>{const g=Ft(h),y=hn(g,h);if(!y)return[[0,0],[0,0]];const L=gt(h,m,y);return(g.anchorNode===g.focusNode?g.anchorOffset>g.focusOffset:2&(M=g.anchorNode,T=g.focusNode,M.compareDocumentPosition(T)))?[L[1],L[0]]:L;var M,T})(c,W)},ke=()=>{const h=Q.O();if(Q.M(!1),h.length){let m;for(;m=h.pop();)if(m.type==="childList"){const{target:g,removedNodes:y,addedNodes:L,nextSibling:M}=m;for(let T=y.length-1;T>=0;T--)g.insertBefore(y[T],M);for(let T=L.length-1;T>=0;T--)g.removeChild(L[T])}else m.target.nodeValue=m.oldValue;Q.O()}$(R),B=!1,R=null,P=xe(z,c,s,W)},We=h=>{if(!B){if(a&&a(h))h.preventDefault();else if((h.metaKey||h.ctrlKey)&&!h.altKey&&h.code==="KeyZ"&&(h.preventDefault(),Q.M(!1),!d)){const m=h.shiftKey?b.redo():b.undo();m&&(u(e(m[0])),p(m[1]))}}},Ve=()=>{B||ke()},qe=h=>{h.preventDefault();const m=h.inputType;if(m.startsWith("format")||m==="historyUndo"||m==="historyRedo")return;B?Q.M(!0):ee();const g=h.getTargetRanges()[0];if(g){const y=gt(c,W,g);let L=m==="insertParagraph"||m==="insertLineBreak"?`
`:h.data;if(L==null){const M=h.dataTransfer;M&&(L=M.getData("text/plain"))}R||(R=new Z().select(...s)),K(...y)!==0&&R.delete(...y),L&&R.insert(y[0],He(L))}B||ke()},Ke=()=>{B||ee(),B=!0},je=()=>{ke()},ze=()=>{ie=!0,ee()},Ge=()=>{ie=!1},Je=()=>{P?P=!1:!ie||B||se||ee()},we=h=>{ee(),K(...s)!==0&&r(h,((m,g,y)=>ge(g,y)===0?[X(X(m[g[0]],y[1])[0],g[1])[1]]:[X(m[g[0]],g[1])[1],...m.slice(g[0]+1,y[0]),X(m[y[0]],y[1])[0]])(f(),...ae(s)),c)},Ze=h=>{h.preventDefault(),we(h.clipboardData)},Qe=h=>{h.preventDefault(),d||(we(h.clipboardData),$(new Z().delete(...ae(s))))},Xe=h=>{h.preventDefault();const[m,g]=ae(s);$(new Z().delete(m,g).insert(m,_(h.clipboardData,W)))},Ye=h=>{h.preventDefault();const m=h.dataTransfer,g=((y,L,{clientX:M,clientY:T},I)=>{if(y.caretPositionFromPoint){const G=y.caretPositionFromPoint(M,T);if(G)return $e(L,G.offsetNode,G.offset,I)}else if(y.caretRangeFromPoint){const G=y.caretRangeFromPoint(M,T);if(G)return $e(L,G.startContainer,G.startOffset,I)}})(z,c,h,W);if(m&&g){const y=new Z;se&&y.delete(...ae(s));const L=y.rebasePos(g);y.select(L,L).insert(L,_(m,W)).select(L),$(y),c.focus({preventScroll:!0})}},et=h=>{se=!0,we(h.dataTransfer)},tt=()=>{se=!1};return z.addEventListener("selectionchange",Je),c.addEventListener("keydown",We),c.addEventListener("input",Ve),c.addEventListener("beforeinput",qe),c.addEventListener("compositionstart",Ke),c.addEventListener("compositionend",je),c.addEventListener("focus",ze),c.addEventListener("blur",Ge),c.addEventListener("copy",Ze),c.addEventListener("cut",Qe),c.addEventListener("paste",Xe),c.addEventListener("drop",Ye),c.addEventListener("dragstart",et),c.addEventListener("dragend",tt),()=>{O||(O=!0,i=p=ue,c.contentEditable=w,c.role=S,c.ariaMultiLine=F,c.ariaReadOnly=C,c.style.whiteSpace=A,Q.I(),z.removeEventListener("selectionchange",Je),c.removeEventListener("keydown",We),c.removeEventListener("input",Ve),c.removeEventListener("beforeinput",qe),c.removeEventListener("compositionstart",Ke),c.removeEventListener("compositionend",je),c.removeEventListener("focus",ze),c.removeEventListener("blur",Ge),c.removeEventListener("copy",Ze),c.removeEventListener("cut",Qe),c.removeEventListener("paste",Xe),c.removeEventListener("drop",Ye),c.removeEventListener("dragstart",et),c.removeEventListener("dragend",tt))}},command:(c,...w)=>{const S=c(f(),s,...w);S&&$(S)},readonly:c=>{d=c,i()}}},gn=({multiline:t}={})=>({single:!t,js:Ce,doc:He,copy:(e,n)=>{e.setData("text/plain",Ce(n))},paste:e=>He(e.getData("text/plain"))});function yn(){const t=Zt(null),[e,n]=zt(`Hello world.
こんにちは。
👍❤️🧑‍🧑‍🧒`);return Jt(()=>{if(t.current)return mn({doc:e,schema:gn({multiline:!0}),onChange:n}).input(t.current)},[]),de("div",{ref:t,style:{backgroundColor:"white",border:"solid 1px darkgray",padding:8},children:e.split(`
`).map((r,_)=>de("div",{children:r||de("br",{})},_))})}Kt(de(yn,{}),document.getElementById("app"));
